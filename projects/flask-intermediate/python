# projects/flask-intermediate/manage.py

from app import create_app, db
from app.models import User
import click

app = create_app()


@app.cli.command("init-db")
def init_db():
    with app.app_context():
        db.create_all()
        if not User.query.filter_by(username='admin').first():
            user = User(username='admin')
            user.set_password('adminpass')
            db.session.add(user)
            db.session.commit()
        click.echo("Initialized the database and seeded default users.")
